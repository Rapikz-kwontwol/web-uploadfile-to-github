<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Upload File</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="icon" type="image/x-icon" href="https://raw.githubusercontent.com/upload-file-lab/fileupload7/main/uploads/1766330286639.jpeg?format=png&name=900x900">
    
    <!-- Konfigurasi Tailwind untuk dark mode -->
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {}
            }
        }
    </script>
    
    <style>
        /* Transisi halus untuk tema */
        * {
            transition: background-color 0.3s ease, border-color 0.3s ease, color 0.3s ease;
        }
        
        /* Pastikan body mengambil full height */
        body, html {
            min-height: 100%;
            margin: 0;
            padding: 0;
        }
        
        /* Animasi */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-out;
        }
        
        /* Custom scrollbar untuk dark mode */
        .dark-scrollbar::-webkit-scrollbar {
            width: 8px;
        }
        
        .dark-scrollbar::-webkit-scrollbar-track {
            background: #1a1a1a;
        }
        
        .dark-scrollbar::-webkit-scrollbar-thumb {
            background: #444444;
            border-radius: 4px;
        }
        
        .dark-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #555555;
        }
        
        /* Custom scrollbar untuk light mode */
        .light-scrollbar::-webkit-scrollbar {
            width: 8px;
        }
        
        .light-scrollbar::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        
        .light-scrollbar::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }
        
        .light-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
        
        /* Style untuk file preview */
        .file-preview-image {
            max-height: 200px;
            object-fit: contain;
        }
        
        /* Glow effect untuk card */
        .card-glow {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .card-glow:hover {
            transform: translateY(-5px);
        }
        
        .dark-card:hover {
            box-shadow: 0 20px 30px rgba(255, 255, 255, 0.05);
        }
        
        .light-card:hover {
            box-shadow: 0 20px 30px rgba(0, 0, 0, 0.1);
        }
        
        /* Fix untuk background body */
        .dark-body {
            background-color: #000000 !important;
        }
        
        .light-body {
            background-color: #f9fafb !important;
        }
    </style>
</head>
<body class="min-h-screen bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100">
    <!-- Tombol Toggle Dark/Light Mode -->
    <div class="fixed top-4 right-4 z-50">
        <button id="theme-toggle" type="button" 
            class="p-3 rounded-full bg-white dark:bg-gray-800 text-gray-900 dark:text-white 
                   hover:bg-gray-100 dark:hover:bg-gray-700 transition duration-300 
                   focus:outline-none focus:ring-2 focus:ring-gray-400 dark:focus:ring-gray-500
                   shadow-lg border border-gray-200 dark:border-gray-700">
            <!-- Ikon bulan (untuk dark mode) -->
            <svg id="theme-toggle-dark-icon" class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path>
            </svg>
            <!-- Ikon matahari (untuk light mode) -->
            <svg id="theme-toggle-light-icon" class="w-6 h-6 hidden" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                <path d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" fill-rule="evenodd" clip-rule="evenodd"></path>
            </svg>
        </button>
    </div>

    <div class="flex flex-col items-center justify-center min-h-screen p-4">
        <div class="mb-8 text-center">
            <img src="https://raw.githubusercontent.com/upload-file-lab/fileupload7/main/uploads/1766330547277.png" 
                 class="rounded-lg shadow-lg mx-auto max-w-[250px] h-auto" 
                 alt="Upload File Logo">
        </div>

        <div id="main-card"
             class="w-full max-w-md bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 
                    rounded-xl shadow-xl p-8 card-glow">
            <h1 class="text-3xl font-extrabold text-center mb-6 text-gray-900 dark:text-white">Upload File</h1>     
            <p class="text-center mb-6 text-gray-600 dark:text-gray-300">
                Semua ukuran file diperbolehkan
            </p>
            
            <form ref="uploadForm" id="uploadForm" action="/uploadfile" method="post" encType="multipart/form-data" class="space-y-6">
                <!-- Custom File Input Area -->
                <div id="file-drop-area" 
                     class="border-2 border-dashed rounded-xl p-8 text-center cursor-pointer
                            border-gray-300 dark:border-gray-600 
                            bg-gray-50 dark:bg-gray-900
                            hover:bg-gray-100 dark:hover:bg-gray-700
                            transition duration-300">
                    <div class="flex flex-col items-center justify-center">
                        <svg class="w-12 h-12 mb-4 text-gray-600 dark:text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
                        </svg>
                        <p class="text-lg font-medium mb-2 text-gray-900 dark:text-white">Klik atau tarik file ke sini</p>
                        <p class="text-sm text-gray-500 dark:text-gray-400">Format: Semua file</p>
                    </div>
                    <input type="file" name="file" id="fileInput" class="hidden" />
                </div>
                
                <!-- File Preview Area -->
                <div id="preview-area" class="hidden">
                    <div id="preview-content" 
                         class="border border-gray-200 dark:border-gray-600 rounded-xl p-4 bg-gray-50 dark:bg-gray-900">
                        <!-- Preview akan ditampilkan di sini oleh JavaScript -->
                    </div>
                    <div class="mt-4 flex justify-between items-center">
                        <span id="file-name" class="font-medium text-gray-900 dark:text-white truncate max-w-xs"></span>
                        <button type="button" id="remove-file" 
                                class="px-3 py-1 rounded text-sm font-medium
                                       bg-red-100 dark:bg-red-900/30 
                                       text-red-700 dark:text-red-300
                                       hover:bg-red-200 dark:hover:bg-red-800/50
                                       transition duration-300">
                            Hapus
                        </button>
                    </div>
                </div>
                
                <div class="flex justify-center items-center space-x-4">
                    <button type="submit" id="uploadButton" 
                            class="px-8 py-3 rounded-full font-bold shadow-lg
                                   bg-gray-900 dark:bg-gray-700 
                                   text-white
                                   hover:bg-gray-800 dark:hover:bg-gray-600
                                   disabled:opacity-50 disabled:cursor-not-allowed
                                   transition duration-300
                                   focus:outline-none focus:ring-2 focus:ring-gray-400 dark:focus:ring-gray-500
                                   transform hover:scale-105">
                        Upload File
                    </button>
                    <div id="loadingIndicator" class="hidden">
                        <svg class="animate-spin h-7 w-7 text-gray-900 dark:text-white" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                        </svg>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Element references
        const themeToggleBtn = document.getElementById('theme-toggle');
        const themeToggleDarkIcon = document.getElementById('theme-toggle-dark-icon'); // Ikon bulan
        const themeToggleLightIcon = document.getElementById('theme-toggle-light-icon'); // Ikon matahari
        const htmlElement = document.documentElement;
        const bodyElement = document.body;
        const fileDropArea = document.getElementById('file-drop-area');
        const fileInput = document.getElementById('fileInput');
        const previewArea = document.getElementById('preview-area');
        const previewContent = document.getElementById('preview-content');
        const fileNameSpan = document.getElementById('file-name');
        const removeFileBtn = document.getElementById('remove-file');
        const uploadButton = document.getElementById('uploadButton');
        const uploadForm = document.getElementById('uploadForm');
        const loadingIndicator = document.getElementById('loadingIndicator');
        const mainCard = document.getElementById('main-card');

        // State
        let selectedFile = null;

        // Fungsi untuk mengatur tema
        function setTheme(isDark) {
            if (isDark) {
                // Mode Gelap: tampilkan bulan üåô
                htmlElement.classList.add('dark');
                bodyElement.classList.add('dark-body');
                bodyElement.classList.remove('light-body');
                localStorage.setItem('theme', 'dark');
                
                // Tampilkan ikon bulan, sembunyikan ikon matahari
                themeToggleDarkIcon.classList.remove('hidden'); // Tampilkan bulan
                themeToggleLightIcon.classList.add('hidden'); // Sembunyikan matahari
                
                mainCard.classList.add('dark-card');
                mainCard.classList.remove('light-card');
            } else {
                // Mode Terang: tampilkan matahari ‚òÄÔ∏è
                htmlElement.classList.remove('dark');
                bodyElement.classList.remove('dark-body');
                bodyElement.classList.add('light-body');
                localStorage.setItem('theme', 'light');
                
                // Tampilkan ikon matahari, sembunyikan ikon bulan
                themeToggleDarkIcon.classList.add('hidden'); // Sembunyikan bulan
                themeToggleLightIcon.classList.remove('hidden'); // Tampilkan matahari
                
                mainCard.classList.add('light-card');
                mainCard.classList.remove('dark-card');
            }
            
            // Update scrollbar class
            updateScrollbarClass();
        }

        // Fungsi untuk update scrollbar berdasarkan tema
        function updateScrollbarClass() {
            const isDark = htmlElement.classList.contains('dark');
            if (isDark) {
                bodyElement.classList.remove('light-scrollbar');
                bodyElement.classList.add('dark-scrollbar');
            } else {
                bodyElement.classList.remove('dark-scrollbar');
                bodyElement.classList.add('light-scrollbar');
            }
        }

        // Cek tema yang disimpan atau preferensi sistem
        function initTheme() {
            const savedTheme = localStorage.getItem('theme');
            const systemPrefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            
            // Jika sudah ada tema yang disimpan, gunakan itu
            if (savedTheme === 'dark') {
                setTheme(true);
            } else if (savedTheme === 'light') {
                setTheme(false);
            } else {
                // Jika tidak ada yang disimpan, ikuti preferensi sistem
                if (systemPrefersDark) {
                    setTheme(true);
                } else {
                    setTheme(false);
                }
            }
        }

        // Toggle tema
        themeToggleBtn.addEventListener('click', () => {
            const isDark = htmlElement.classList.contains('dark');
            setTheme(!isDark);
        });

        // Fungsi untuk menampilkan preview file
        function showFilePreview(file) {
            selectedFile = file;
            previewArea.classList.remove('hidden');
            previewArea.classList.add('fade-in');
            
            // Tampilkan nama file
            fileNameSpan.textContent = file.name;
            
            // Reset preview content
            previewContent.innerHTML = '';
            
            // Tampilkan preview berdasarkan tipe file
            if (file.type.startsWith('image/')) {
                // Preview gambar
                const reader = new FileReader();
                reader.onload = function(e) {
                    const img = document.createElement('img');
                    img.src = e.target.result;
                    img.className = 'file-preview-image rounded-lg shadow-md w-full';
                    img.alt = 'Preview gambar';
                    previewContent.appendChild(img);
                };
                reader.readAsDataURL(file);
            } else if (file.type.startsWith('video/')) {
                // Preview video
                const video = document.createElement('video');
                video.src = URL.createObjectURL(file);
                video.controls = true;
                video.className = 'file-preview-image rounded-lg shadow-md w-full';
                previewContent.appendChild(video);
            } else if (file.type === 'application/pdf') {
                // Preview PDF
                const pdfIcon = document.createElement('div');
                pdfIcon.className = 'text-center py-4';
                pdfIcon.innerHTML = `
                    <div class="text-5xl mb-2">üìÑ</div>
                    <p class="text-lg font-medium text-gray-900 dark:text-white">PDF Document</p>
                    <p class="text-sm text-gray-500 dark:text-gray-400">${(file.size / (1024 * 1024)).toFixed(2)} MB</p>
                `;
                previewContent.appendChild(pdfIcon);
            } else {
                // Preview file umum
                const fileIcon = document.createElement('div');
                fileIcon.className = 'text-center py-4';
                fileIcon.innerHTML = `
                    <div class="text-5xl mb-2">üìÅ</div>
                    <p class="text-lg font-medium text-gray-900 dark:text-white">${file.type || 'Unknown File'}</p>
                    <p class="text-sm text-gray-500 dark:text-gray-400">${(file.size / (1024 * 1024)).toFixed(2)} MB</p>
                `;
                previewContent.appendChild(fileIcon);
            }
            
            // Enable tombol upload
            uploadButton.disabled = false;
        }

        // Event listener untuk area drop file
        fileDropArea.addEventListener('click', () => fileInput.click());
        
        fileDropArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            fileDropArea.classList.add('bg-gray-200', 'dark:bg-gray-700');
        });
        
        fileDropArea.addEventListener('dragleave', () => {
            fileDropArea.classList.remove('bg-gray-200', 'dark:bg-gray-700');
        });
        
        fileDropArea.addEventListener('drop', (e) => {
            e.preventDefault();
            fileDropArea.classList.remove('bg-gray-200', 'dark:bg-gray-700');
            
            if (e.dataTransfer.files.length) {
                const file = e.dataTransfer.files[0];
                // Tidak ada validasi ukuran file
                fileInput.files = e.dataTransfer.files;
                showFilePreview(file);
            }
        });

        // Event listener untuk input file
        fileInput.addEventListener('change', (e) => {
            if (e.target.files.length) {
                const file = e.target.files[0];
                // Tidak ada validasi ukuran file
                showFilePreview(file);
            }
        });

        // Event listener untuk tombol hapus file
        removeFileBtn.addEventListener('click', () => {
            selectedFile = null;
            fileInput.value = '';
            previewArea.classList.add('hidden');
            previewArea.classList.remove('fade-in');
            
            // Disable tombol upload
            uploadButton.disabled = true;
        });

        // Validasi sebelum upload
        uploadForm.addEventListener('submit', (e) => {
            if (!selectedFile) {
                e.preventDefault();
                alert('Pilih file terlebih dahulu!');
                return;
            }
            
            // Tampilkan loading
            uploadButton.disabled = true;
            loadingIndicator.classList.remove('hidden');
        });

        // Inisialisasi
        function init() {
            initTheme();
            uploadButton.disabled = true;
        }

        // Jalankan inisialisasi
        init();
        
        // Juga atur tema saat halaman selesai load
        document.addEventListener('DOMContentLoaded', initTheme);
    </script>
</body>
</html>
